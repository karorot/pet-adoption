# Pet adoption

A web application created for the course "Tietokannat ja web-ohjelmointi" at University of Helsinki. In the application, users can create listings to find a new home for their pets and leave applications to other users' pets.

## Features

* Users can create an account and log in and out of the application.
* Users can add, edit, and delete listings for pets they would like to put up for adoption to a new home.
* The following information can be added to a listing:
    * Basic details (e.g. pet's name, breed, gender, age), some of which are stored and accessed via categories in the database.
    * Images of the pet.
    * A free-form text description.
* Users can view and browse pet listings added to the application and search with a keyword.
* Users can submit an adoption application for another user's pet.
    * Pet owners can see the applications submitted for their pets.
    * Users can see the applications they have submitted themselves.
* Users have user pages that show statistics, such as the number of pet listings created by them and the applications submitted.

## How to install and test

Install Flask:
```
$ pip install flask
```

Create the tables for the database:
```
$ sqlite3 database.db < schema.sql
$ sqlite3 database.db < init.sql
```

Run the application:
```
$ flask run
```

## Attribution

Default pet listing image used on the front page from [Pixabay](https://pixabay.com/illustrations/pawprints-paw-prints-paw-animal-2919733/).

## Handling large amounts of data

The was tested with a large amount of data using the script found in the file ```seed.py```. The script creates the desired number of users, pets, and applications. Pets are randomly assigned to users, and applications are similarly assigned randomly to different pets and users. To help with testing, users are also all assigned a simple password so login is possible.

The following precautions have been taken to make even large amounts of data easily manageable:
* Pagination of data entries is implemented on the main page, user profile, pet profile and search results
* The database has indexes to speed up processing (e.g. for retrieving pets for a user, retrieving applications for a user, on so on.).

When the application was tested with the data generated by the script, the time taken by the application to respond to different page requests was measured. For this purpose, two assisting functions from the course material, which were used to measure the response time for each page request, were temporarily added to file ```app.py```.

```
@app.before_request
def before_request():
    g.start_time = time.time()
```

```
@app.after_request
def after_request(response):
    elapsed_time = round(time.time() - g.start_time, 2)
    print("Time elapsed:", elapsed_time, "s")
    return response
```

### Timing page requests before indexing
Before adding the indexes, the homepage loaded already fairly quickly due to pagination, but for example the search page and user pages responded much more slowly. The delay while searching felt somewhat disruptive to the user, and especially loading the user pages took several seconds. Here are some exact response times before indexing:

User profile:
```
Time elapsed: 3.0 s
127.0.0.1 - - [15/Oct/2025 18:54:08] "GET /user/392 HTTP/1.1" 200 -
Time elapsed: 2.93 s
127.0.0.1 - - [15/Oct/2025 18:54:29] "GET /user/393 HTTP/1.1" 200 -
Time elapsed: 2.93 s
127.0.0.1 - - [15/Oct/2025 18:54:34] "GET /user/394 HTTP/1.1" 200 -
```

Search:
```
Time elapsed: 0.38 s
127.0.0.1 - - [15/Oct/2025 18:52:17] "GET /search/4?query=location HTTP/1.1" 200 -
Time elapsed: 0.37 s
127.0.0.1 - - [15/Oct/2025 18:52:32] "GET /search/5?query=location HTTP/1.1" 200 -
Time elapsed: 0.39 s
127.0.0.1 - - [15/Oct/2025 18:52:34] "GET /search/6?query=location HTTP/1.1" 200 -
```

### Timing page requests after indexing
Adding indexes to the database sped up the page requests considerably. Here are the results from the most important pages showing several data entries.

Main page:
```
Time elapsed: 0.02 s
127.0.0.1 - - [15/Oct/2025 18:59:54] "GET / HTTP/1.1" 200 -
Time elapsed: 0.0 s
127.0.0.1 - - [15/Oct/2025 19:00:00] "GET /2 HTTP/1.1" 200 -
Time elapsed: 0.0 s
127.0.0.1 - - [15/Oct/2025 19:00:03] "GET /3 HTTP/1.1" 200 -
```

User page:
```
Time elapsed: 0.01 s
127.0.0.1 - - [15/Oct/2025 19:25:03] "GET /user/793 HTTP/1.1" 200 -
Time elapsed: 0.01 s
127.0.0.1 - - [15/Oct/2025 19:25:06] "GET /user/794 HTTP/1.1" 200 -
Time elapsed: 0.01 s
127.0.0.1 - - [15/Oct/2025 19:25:08] "GET /user/795 HTTP/1.1" 200 -
```

Search:
```
Time elapsed: 0.16 s
127.0.0.1 - - [15/Oct/2025 19:38:16] "GET /search?query=location HTTP/1.1" 200 -
Time elapsed: 0.16 s
127.0.0.1 - - [15/Oct/2025 19:38:20] "GET /search/2?query=location HTTP/1.1" 200 -
Time elapsed: 0.16 s
127.0.0.1 - - [15/Oct/2025 19:38:23] "GET /search/3?query=location HTTP/1.1" 200 -
```

As can be seen, speeding up the search functionality proved to be complicated. At best, requests were made in above times, but at worst, it still took around 0.3-0.4 seconds with longer keywords. After studying the query plans with SQLite, it seems that using the LIKE operator in the search query prevents SQLite from using the indexes as efficiently as possible, though there is still some effect. Therefore, the searches are not as fast as loading other pages in the app. Tho speed this up, searching would likely beed to be done in some other way, e.g. Full-Text Search.

Lastly, creating a new pet, editing pet information, and deleting pets were also tested to ensure that there were no delays in these operations after adding the indexes. Creating a new user is still fast as well.